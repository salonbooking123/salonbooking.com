// queueTimers.js function startAllSalonTimers() { const cards = document.querySelectorAll(".live-box"); cards.forEach(card => { const salonId = card.dataset.salon; startTimerForSalon(salonId, card); }); } function startTimerForSalon(salonId, card) { // fetch bookings for this salon let bookings = JSON.parse(localStorage.getItem("bs_bookings_v1") || "[]") .filter(b => b.salonId == salonId); let totalMinutes = bookings.reduce((sum, b) => sum + (b.timeRequired || 0), 0); const waitBox = card.querySelector(".waitTime"); const countBox = card.querySelector(".countDisplay"); if(totalMinutes <= 0){ waitBox.textContent = 0; countBox.textContent = "No customers..."; return; } waitBox.textContent = totalMinutes; let remaining = totalMinutes * 60; // convert to seconds // Clear old timers if(card._timer) clearInterval(card._timer); card._timer = setInterval(() => { if(remaining <= 0){ clearInterval(card._timer); waitBox.textContent = 0; countBox.textContent = "No customers..."; return; } remaining--; // Convert seconds â†’ mm:ss let m = Math.floor(remaining / 60); let s = remaining % 60; countBox.textContent = ${m}m ${s}s; }, 1000); }